package Vista;

import Controlador.ReporteDAO;

import javax.swing.*;
import javax.swing.table.DefaultTableModel;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.time.LocalDate;
import java.util.List;

public class ReporteGUI {
    private JPanel Main;
    private JButton ventasDelDiaButton;
    private JButton ventasDeLaSemanaButton;
    private JButton ventasDelMesButton;
    private JButton productosMasVendidosButton;
    private JButton clientesConMasComprasButton;
    private JList list1;
    private JList list2;
    private JTable table1;
    private JButton ventasDia;
    private JButton ventasSemana;
    private JButton ventasMes;
    private JButton productosMasVendidos;
    private JButton clientesTopButton;

    private ReporteDAO dao;

    public ReporteGUI() {
        dao = new ReporteDAO();


        ventasDelDiaButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                String hoy = LocalDate.now().toString();
                double total = dao.totalVentas(hoy, hoy);
                mostrarResultadoUnico("Total ventas hoy", total);
            }
        });


        ventasDeLaSemanaButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                String hoy = LocalDate.now().toString();
                String semana = LocalDate.now().minusDays(7).toString();
                double total = dao.totalVentas(semana, hoy);
                mostrarResultadoUnico("Total ventas semana", total);
            }
        });


        ventasDelMesButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                String hoy = LocalDate.now().toString();
                String mes = LocalDate.now().minusMonths(1).toString();
                double total = dao.totalVentas(mes, hoy);
                mostrarResultadoUnico("Total ventas mes", total);
            }
        });


        productosMasVendidosButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                List<String[]> productos = dao.productosMasVendidos();
                mostrarTabla(productos, new String[]{"Producto", "Cantidad Vendida"});
            }
        });


        clientesConMasComprasButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                List<String[]> clientes = dao.clientesConMasCompras();
                mostrarTabla(clientes, new String[]{"Cliente", "Compras"});
            }
        });

        clientesTopButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {

            }
        });
    }


    private void mostrarResultadoUnico(String titulo, double total) {
        DefaultTableModel model = new DefaultTableModel();
        model.addColumn("Reporte");
        model.addColumn("Resultado");
        model.addRow(new Object[]{titulo, total});
        table1.setModel(model);
    }


    private void mostrarTabla(List<String[]> datos, String[] columnas) {
        DefaultTableModel model = new DefaultTableModel(columnas, 0);
        for (String[] fila : datos) {
            model.addRow(fila);
        }
        table1.setModel(model);
    }


    public static void main(String[] args) {
        JFrame frame = new JFrame("Reportes de Ventas");
        frame.setContentPane(new ReporteGUI().Main);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(800, 500);
        frame.setVisible(true);
        frame.setResizable(false);
        frame.setLocationRelativeTo(null);
    }
}

}
